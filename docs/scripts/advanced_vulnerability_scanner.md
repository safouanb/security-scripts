# Advanced Vulnerability Scanner

## Overview
The Advanced Vulnerability Scanner is a professional-grade Python script for comprehensive web application security testing. It performs automated vulnerability discovery using multiple attack vectors including XSS, SQL injection, SSRF, LFI, and RCE testing.

## Features
- ✅ **Advanced XSS Detection** - Multiple payloads and filter bypass techniques
- ✅ **SQL Injection Testing** - Union-based, time-based, and error-based detection
- ✅ **SSRF Testing** - Server-side request forgery vulnerability detection
- ✅ **LFI/RFI Testing** - Local and remote file inclusion testing
- ✅ **RCE Testing** - Remote code execution vulnerability detection
- ✅ **Parameter Fuzzing** - Automated parameter discovery and testing
- ✅ **Session Management** - Cookie and session handling
- ✅ **Report Generation** - Detailed vulnerability reports

## Usage

### Basic Usage
```bash
# Scan a single target
python scripts/web/advanced_vulnerability_scanner.py example.com

# Scan with specific options
python scripts/web/advanced_vulnerability_scanner.py https://example.com --depth 2 --threads 10
```

### Advanced Usage
```bash
# Comprehensive scan with custom payloads
python scripts/web/advanced_vulnerability_scanner.py https://example.com \
    --depth 3 \
    --threads 20 \
    --timeout 10 \
    --output results.json \
    --verbose

# Scan specific endpoints
python scripts/web/advanced_vulnerability_scanner.py https://example.com/api \
    --endpoints /users,/admin,/search \
    --methods GET,POST,PUT
```

## Parameters

| Parameter | Short | Description | Default |
|-----------|-------|-------------|---------|
| `target` | | Target URL to scan | Required |
| `--depth` | `-d` | Crawling depth | 2 |
| `--threads` | `-t` | Number of concurrent threads | 10 |
| `--timeout` | | Request timeout in seconds | 5 |
| `--output` | `-o` | Output file for results | None |
| `--verbose` | `-v` | Verbose output | False |
| `--endpoints` | `-e` | Specific endpoints to test | Auto-discovered |
| `--methods` | `-m` | HTTP methods to test | GET,POST |
| `--user-agent` | `-u` | Custom user agent | Default browser |

## Vulnerability Types Tested

### 1. Cross-Site Scripting (XSS)
- **Reflected XSS** - Input reflection testing
- **Stored XSS** - Persistent XSS testing
- **DOM XSS** - Client-side XSS testing
- **WAF Bypass** - Advanced payload techniques

### 2. SQL Injection
- **Union-based** - Data extraction via UNION queries
- **Time-based Blind** - Timing-based detection
- **Error-based** - Error message exploitation
- **Boolean-based Blind** - Boolean-based detection

### 3. Server-Side Request Forgery (SSRF)
- **Internal Network** - Internal service discovery
- **Port Scanning** - Internal port scanning
- **Protocol Smuggling** - Protocol-based attacks
- **Cloud Metadata** - Cloud instance metadata access

### 4. Local File Inclusion (LFI)
- **Directory Traversal** - Path traversal attacks
- **File Upload** - Malicious file upload testing
- **Log Poisoning** - Log file inclusion attacks
- **PHP Wrappers** - PHP-specific LFI techniques

### 5. Remote Code Execution (RCE)
- **Command Injection** - OS command execution
- **Code Injection** - Application code execution
- **Template Injection** - Template engine exploitation
- **Deserialization** - Object deserialization attacks

## Examples

### 1. Basic Web Application Scan
```bash
# Scan a web application
python scripts/web/advanced_vulnerability_scanner.py https://example.com

# Output:
# [*] Starting advanced vulnerability scan on https://example.com
# [*] Crawling depth: 2
# [*] Using 10 threads
# [*] Advanced XSS scanning: https://example.com/
# [*] SQL injection testing: https://example.com/search
# [*] SSRF testing: https://example.com/api/upload
# [*] LFI testing: https://example.com/view
# [*] RCE testing: https://example.com/admin
# [*] Scan completed: 15 vulnerabilities found
```

### 2. API Security Testing
```bash
# Test API endpoints specifically
python scripts/web/advanced_vulnerability_scanner.py https://api.example.com \
    --endpoints /users,/admin,/search \
    --methods GET,POST,PUT,DELETE \
    --depth 1
```

### 3. High-Intensity Scan
```bash
# Comprehensive scan with high thread count
python scripts/web/advanced_vulnerability_scanner.py https://example.com \
    --depth 3 \
    --threads 50 \
    --timeout 15 \
    --output comprehensive_scan.json \
    --verbose
```

### 4. Targeted Testing
```bash
# Test specific vulnerability types
python scripts/web/advanced_vulnerability_scanner.py https://example.com \
    --vuln-types xss,sql-injection \
    --endpoints /search,/login,/profile
```

## Output Format

### Console Output
```
[*] Starting advanced vulnerability scan on https://example.com
[*] Crawling depth: 2
[*] Using 10 threads
[*] Advanced XSS scanning: https://example.com/
[*] SQL injection testing: https://example.com/search
[*] SSRF testing: https://example.com/api/upload
[*] LFI testing: https://example.com/view
[*] RCE testing: https://example.com/admin
[*] Scan completed: 15 vulnerabilities found

VULNERABILITIES FOUND:
====================
1. XSS (Reflected) - https://example.com/search?q=<script>alert('XSS')</script>
2. SQL Injection - https://example.com/login (username parameter)
3. SSRF - https://example.com/api/upload (url parameter)
4. LFI - https://example.com/view?file=../../../etc/passwd
5. RCE - https://example.com/admin (command parameter)
```

### JSON Output
```json
{
  "target": "https://example.com",
  "scan_time": "2024-01-15T10:30:00Z",
  "total_vulnerabilities": 15,
  "vulnerabilities": [
    {
      "type": "XSS",
      "severity": "High",
      "url": "https://example.com/search",
      "parameter": "q",
      "payload": "<script>alert('XSS')</script>",
      "description": "Reflected XSS vulnerability in search parameter"
    },
    {
      "type": "SQL Injection",
      "severity": "Critical",
      "url": "https://example.com/login",
      "parameter": "username",
      "payload": "' OR '1'='1",
      "description": "SQL injection vulnerability in login form"
    }
  ]
}
```

## Advanced Features

### 1. Custom Payloads
```bash
# Use custom payload files
python scripts/web/advanced_vulnerability_scanner.py https://example.com \
    --xss-payloads custom_xss.txt \
    --sql-payloads custom_sql.txt
```

### 2. Session Management
```bash
# Use authentication cookies
python scripts/web/advanced_vulnerability_scanner.py https://example.com \
    --cookies "session=abc123; auth=xyz789"
```

### 3. Proxy Support
```bash
# Use proxy for scanning
python scripts/web/advanced_vulnerability_scanner.py https://example.com \
    --proxy http://127.0.0.1:8080
```

### 4. Rate Limiting
```bash
# Respect rate limits
python scripts/web/advanced_vulnerability_scanner.py https://example.com \
    --delay 1.0 \
    --max-requests 100
```

## Security Considerations

### Legal and Ethical Use
- ✅ **Use only on systems you own or have explicit permission to test**
- ✅ **Follow responsible disclosure** practices
- ✅ **Respect rate limits** to avoid overwhelming targets
- ✅ **Document all findings** for proper reporting
- ❌ **Never use for malicious purposes**
- ❌ **Never test systems without authorization**

### Best Practices
1. **Start with low-intensity scans** to avoid overwhelming targets
2. **Use appropriate delays** between requests
3. **Respect robots.txt** and rate limiting
4. **Document all findings** with proper evidence
5. **Follow responsible disclosure** for any vulnerabilities found

## Troubleshooting

### Common Issues

#### 1. Connection Timeouts
```bash
# Increase timeout for slow networks
python scripts/web/advanced_vulnerability_scanner.py https://example.com --timeout 15
```

#### 2. Rate Limiting
```bash
# Add delays between requests
python scripts/web/advanced_vulnerability_scanner.py https://example.com --delay 2.0
```

#### 3. Authentication Required
```bash
# Use authentication cookies
python scripts/web/advanced_vulnerability_scanner.py https://example.com \
    --cookies "session=abc123; auth=xyz789"
```

#### 4. WAF Blocking
```bash
# Use different user agents and techniques
python scripts/web/advanced_vulnerability_scanner.py https://example.com \
    --user-agent "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
```

## Dependencies
- Python 3.8+
- requests
- beautifulsoup4
- urllib3
- concurrent.futures

## Related Scripts
- [SQL Injection Tester](sql_injection_tester.md) - Focused SQL injection testing
- [API Security Tester](api_security_tester.md) - API-specific security testing
- [OAuth Scanner](oauth_scanner.md) - OAuth misconfiguration detection

## License
MIT License - See [LICENSE](../../LICENSE) for details
